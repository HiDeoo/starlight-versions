---
import Default from '@astrojs/starlight/components/Sidebar.astro'
import type { Props } from '@astrojs/starlight/props'
import starlightVersionsConfig from 'virtual:starlight-versions-config'

import { getPageSlug } from '../libs/starlight'
import { getVersionFromSlug, getVersionSidebar } from '../libs/versions'

const sidebar = getVersionSidebar(
  getVersionFromSlug(starlightVersionsConfig, getPageSlug(Astro.url)),
  Astro.props.sidebar,
)
---

<Default {...Astro.props} {sidebar}><slot /></Default>
